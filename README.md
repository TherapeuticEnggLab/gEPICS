# gEPICS
This repository contains the generalized EPICS (gEPICS) code used to estimate the effective pairwise interaction coefficients and the full-species abundance in an n-species microbial community. 

MATLAB code:

Inputs:

(i) The number of species in the community (n)
(ii) The monoculture abundances at steady-state
(iii) The leave-one-out abundances at steady-state

Ouputs:

(i) The effective pairwise interaction coefficients in nxn matrix form
(ii) The full species abundance in 1xn form

Example:

This is shown using the synthetic human gut microbiome discussed in the manuscript, where there are species extinctions in leave-one-out subcommunities (Venturelli, O. S., A. V. Carr, G. Fisher, R. H. Hsu, R. Lau, B. P. Bowen, S. Hromada, T. Northen, and A. P. Arkin. 2018. Deciphering microbial interactions in synthetic human gut microbiome communities. Molecular Systems Biology 14:e8157.)

Inputs:

Enter the number of species in the community=12

Enter the monoculture abundances 
(Put your entries wrapped in square brackets. 
Put a space or a comma after each entry)=[0.34123 0.37976 0.64199 0.18143 0.64965 0.74397 0.73636 0.11578 0.1222 0.36556 0.11145 0.00756]

Enter the abundances in leave-one-out subcommunities 
(Put your entries wrapped in square brackets. 
(Rows are subcommunities, columns are species)=[0.0001 0.0222 0.5089 0.0001 0.1998 0.0545 0.2059 0.0252 0.1594 0.0120 0.0030 0.0101;
0.0114 0.0003 0.5463 0.0018 0.2306 0.0429 0.2061 0.0140 0.1572 0.0219 0.0009 0.0201;
0.0133 0.0323 0.0252 0.0070 0.3635 0.1027 0.2292 0.0269 0.3039 0.0109 0.0011 0.0098;
0.0112 0.0252 0.4456 0.0004 0.2444 0.0441 0.2043 0.0195 0.2498 0.0155 0.0014 0.0068;
0.0108 0.0302 0.3199 0.0001 0.0022 0.1855 0.3476 0.0313 0.2457 0.0211 0.0024 0.0111;
0.0176 0.0334 0.4987 0.0001 0.1702 0.0004 0.2700 0.0271 0.2160 0.0148 0.0013 0.0072;
0.0280 0.0410 0.5920 0.0001 0.2858 0.0389 0.0020 0.0212 0.2248 0.0160 0.0008 0.0088;
0.0001 0.0126 0.0652 0.0006 0.2873 0.0447 0.0632 0.0004 0.1978 0.0016 0.0005 0.0035;
0.0048 0.0374 0.4709 0 0.3198 0.0732 0.2725 0.0233 0.0020 0.0347 0.0016 0.0202;
0.0071 0.0094 0.3487 0.0024 0.1814 0.1178 0.1508 0.0259 0.1955 0 0.0048 0.0135;
0.0253 0.0230 0.3403 0.0005 0.2764 0.1119 0.1898 0.0192 0.2691 0.0162 0.0004 0.0140;
0.0139 0.0326 0.4863 0.0004 0.1715 0.0530 0.2052 0.0243 0.2749 0.0135 0.0008 0.0004]

Outputs:

Effective Pairwise Interactions estimated using gEPICS

[-2.93057468569587	4.01044430476529	-0.507209147474193	-4.22432272803786	-0.905939714696374	-0.485343511022184	-0.356784073668509	-11.2744315994691	-0.726829894205718	-6.39411332042107	-34.0765550186790	3.19226393050808;
-20.7576516102060	-2.63324204760903	5.13631332797052	542.307317910649	-7.47917228886883	-1.61555741963970	0.817783765783115	-109.401322359943	1.87155548161674	13.0957247653850	-215.843051577045	74.5871338238299;
11.7710301263345	-28.5445394715635	-1.55765666131872	-114.515300909771	0.245083279074737	-1.56708220138132	-2.07350954474919	42.6356673541443	-1.41612382293395	28.1623196359377	12.2392035104685	-31.8958800719420;
0.206802473606772	-0.554234433573155	-0.838237681421734	-5.51176762387684	-0.253757285531195	-1.67646457867680	-0.676666897824855	-0.502081655736903	-1.70590758418622	0.361720942596807	-0.109307223891407	0.137571655125413;
2.20282844659265	-18.4294372065158	-2.14357144724045	-71.9326422243444	-1.53929038713158	-2.41650873256912	-2.91265724707934	37.1639690943383	0.517848661195095	41.4757790405801	32.1858219058415	-10.1821561045602;
0.378629069601130	-43.4124384846319	-2.42347895313667	-120.681389496272	0.991082085783491	-1.34414022070785	-4.47392817557981	75.4802203178233	-0.449195662016089	55.9701466905542	-12.7132621279825	-45.3910665530614;
9.39373725584559	-41.0079133737009	-2.21755863446305	-116.879656857573	1.25964191824313	-1.93557893230478	-1.35803139768583	63.6706459875929	-1.70761804189252	32.4746243386132	-24.3989178826406	-46.0192285580006;
-2.25529367649675	2.51017748442464	-0.575727091147390	-7.63634625721866	-0.854702945952767	-0.572089837667382	-0.451440160477963	-8.63707030575223	-0.739664769693994	-4.41774828339378	-31.3256099491015	1.53186437576896;
43.6518689140422	-21.6880333891997	-1.05952782990385	-12.5956926944106	3.17395393029199	3.25286988843873	1.40680418170970	6.72130930775243	-8.18330605564650	41.5052660418265	176.357596347175	-96.1648270185453;
150.334610252646	-45.9371417506848	0.660927459920721	160.068211695194	4.69629252261939	9.37216713948455	6.39360679928102	-73.4393789094997	-12.7774927650799	-2.73552905131853	927.994499628422	-194.242248390851;
10.6237414474271	-24.9653842711565	-0.805541230911447	-4.99814111463477	0.269711091511458	-0.0372921756153967	-1.46911057927682	33.7798620691533	-2.31437811419548	26.7635455399804	-8.97263346792289	-55.5722777934395;
30.1958293226725	31.5375868655280	0.915840221607260	-4.36285048592077	1.43805295274910	9.93976896175292	-5.80280193956704	32.1210834734130	-6.63974688332035	-11.4371124263638	-25.9547221311697	-132.275132275133]

Predicted Abundances in the full species community using gEPICS

0.00641177826120376	0.0252939901410592	0.474293809848835	0.000470970650455693	0.232439567865155	0.0337853785381979	0.195806860332935	0.0235116540277157	0.195232531525841	0.0133733639256856	0.00234157256415400	0.00909234742639256
 
